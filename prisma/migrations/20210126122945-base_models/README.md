# Migration `20210126122945-base_models`

This migration has been generated by lmjcbs at 1/26/2021, 12:29:45 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "jobs" (
"id" SERIAL,
    "jid" TEXT NOT NULL,
    "applyActionCTR" INTEGER NOT NULL DEFAULT 0,
    "applyCTA" TEXT NOT NULL,
    "companyName" TEXT,
    "createdEpoch" INTEGER NOT NULL,
    "descriptionAsHTML" TEXT NOT NULL,
    "datePosted" TEXT NOT NULL,
    "expiresEpoch" INTEGER NOT NULL,
    "featured" BOOLEAN NOT NULL DEFAULT false,
    "pageViews" INTEGER NOT NULL DEFAULT 0,
    "salaryCurrency" TEXT,
    "salaryMin" INTEGER,
    "salaryMax" INTEGER,
    "title" TEXT NOT NULL,
    "categoryId" INTEGER NOT NULL,
    "companyId" INTEGER,
    "locationId" INTEGER NOT NULL,
    "typeId" INTEGER NOT NULL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,

    PRIMARY KEY ("id")
)

CREATE TABLE "categories" (
"id" SERIAL,
    "name" TEXT NOT NULL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,

    PRIMARY KEY ("id")
)

CREATE TABLE "companies" (
"id" SERIAL,
    "cid" TEXT NOT NULL,
    "email" TEXT NOT NULL,
    "descriptionAsHTML" TEXT,
    "headquaters" TEXT NOT NULL,
    "logoUrl" TEXT,
    "name" TEXT NOT NULL,
    "statement" TEXT,
    "verified" BOOLEAN NOT NULL DEFAULT false,
    "websiteUrl" TEXT NOT NULL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,

    PRIMARY KEY ("id")
)

CREATE TABLE "locations" (
"id" SERIAL,
    "name" TEXT NOT NULL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,

    PRIMARY KEY ("id")
)

CREATE TABLE "tags" (
"id" SERIAL,
    "name" TEXT NOT NULL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,

    PRIMARY KEY ("id")
)

CREATE TABLE "types" (
"id" SERIAL,
    "name" TEXT NOT NULL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,

    PRIMARY KEY ("id")
)

CREATE TABLE "_JobToTag" (
    "A" INTEGER NOT NULL,
    "B" INTEGER NOT NULL
)

CREATE UNIQUE INDEX "jobs.jid_unique" ON "jobs"("jid")

CREATE INDEX "locationId" ON "jobs"("locationId")

CREATE INDEX "categoryId" ON "jobs"("categoryId")

CREATE UNIQUE INDEX "categories.name_unique" ON "categories"("name")

CREATE UNIQUE INDEX "companies.cid_unique" ON "companies"("cid")

CREATE UNIQUE INDEX "companies.email_unique" ON "companies"("email")

CREATE UNIQUE INDEX "locations.name_unique" ON "locations"("name")

CREATE UNIQUE INDEX "tags.name_unique" ON "tags"("name")

CREATE UNIQUE INDEX "types.name_unique" ON "types"("name")

CREATE UNIQUE INDEX "_JobToTag_AB_unique" ON "_JobToTag"("A", "B")

CREATE INDEX "_JobToTag_B_index" ON "_JobToTag"("B")

ALTER TABLE "jobs" ADD FOREIGN KEY("locationId")REFERENCES "locations"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "jobs" ADD FOREIGN KEY("categoryId")REFERENCES "categories"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "jobs" ADD FOREIGN KEY("companyId")REFERENCES "companies"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "jobs" ADD FOREIGN KEY("typeId")REFERENCES "types"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "_JobToTag" ADD FOREIGN KEY("A")REFERENCES "jobs"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "_JobToTag" ADD FOREIGN KEY("B")REFERENCES "tags"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20210126122945-base_models
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,107 @@
+// This is your Prisma schema file,
+// learn more about it in the docs: https://pris.ly/d/prisma-schema
+
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model Job {
+  id  Int    @id @default(autoincrement())
+  jid String @unique
+
+  applyActionCTR    Int     @default(0)
+  applyCTA          String
+  companyName       String?
+  createdEpoch      Int
+  descriptionAsHTML String
+  datePosted        String
+  expiresEpoch      Int
+  featured          Boolean @default(false)
+  pageViews         Int     @default(0)
+  salaryCurrency    String?
+  salaryMin         Int?
+  salaryMax         Int?
+  title             String
+
+  categoryId Int
+  companyId  Int?
+  locationId Int
+  typeId     Int
+  location   Location @relation(fields: [locationId], references: [id])
+  category   Category @relation(fields: [categoryId], references: [id])
+  company    Company? @relation(fields: [companyId], references: [id])
+  tags       Tag[]    @relation(references: [id])
+  type       Type     @relation(fields: [typeId], references: [id])
+
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+
+  @@index([locationId], name: "locationId")
+  @@index([categoryId], name: "categoryId")
+  @@map(name: "jobs")
+}
+
+model Category {
+  id        Int      @id @default(autoincrement())
+  name      String   @unique
+  jobs      Job[]
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  @@map(name: "categories")
+}
+
+model Company {
+  id                Int      @id @default(autoincrement())
+  cid               String   @unique
+  email             String   @unique
+  descriptionAsHTML String?
+  headquaters       String
+  logoUrl           String?
+  name              String
+  statement         String?
+  verified          Boolean  @default(false)
+  websiteUrl        String
+  jobs              Job[]
+  createdAt         DateTime @default(now())
+  updatedAt         DateTime @updatedAt
+
+  @@map(name: "companies")
+}
+
+model Location {
+  id        Int      @id @default(autoincrement())
+  name      String   @unique
+  jobs      Job[]
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  @@map(name: "locations")
+}
+
+model Tag {
+  id        Int      @id @default(autoincrement())
+  name      String   @unique
+  jobs      Job[]    @relation(references: [id])
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  @@map(name: "tags")
+}
+
+model Type {
+  id        Int      @id @default(autoincrement())
+  name      String   @unique
+  jobs      Job[]
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  @@map(name: "types")
+}
+
```


